<!-- pages/input.html -->
<div class="container">
  <h4>Input Inspeksi Terencana - Minerba</h4>
  <p class="small text-muted">Silakan isi seluruh kolom dengan lengkap. Form ini mencakup data teknis, legal, dan tindak lanjut.</p>

  <form id="formMinerba" class="row g-3 needs-validation" novalidate>
    <div class="col-md-3">
      <label class="form-label">Tanggal Inspeksi</label>
      <input type="date" id="f_tanggal_inspeksi" class="form-control" required />
    </div>
    <div class="col-md-3">
      <label class="form-label">Inspector (Nama)</label>
      <input type="text" id="f_inspector" class="form-control" readonly required />
      <input type="hidden" id="f_inspectorId" />
    </div>
    <div class="col-md-6">
      <label class="form-label">Lokasi / Unit Kerja</label>
      <input type="text" id="f_location" class="form-control" placeholder="Lokasi tambang / unit" required />
    </div>

    <div class="col-md-4">
      <label class="form-label">Area / Seksi</label>
      <input type="text" id="f_area" class="form-control" placeholder="Contoh: Pit A / Stockpile" />
    </div>
    <div class="col-md-4">
      <label class="form-label">Jenis Kegiatan</label>
      <select id="f_activity" class="form-select">
        <option value="">-- Pilih --</option>
        <option value="Penambangan">Penambangan</option>
        <option value="Pengolahan">Pengolahan</option>
        <option value="Transport">Transport</option>
        <option value="Pemeliharaan">Pemeliharaan</option>
        <option value="Pengurukan">Pengurukan</option>
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Kategori Temuan (sesuai minerba)</label>
      <select id="f_category" class="form-select">
        <option value="">-- Pilih Kategori --</option>
        <option value="Keselamatan Kerja">Keselamatan Kerja</option>
        <option value="Lingkungan">Lingkungan</option>
        <option value="Perizinan">Perizinan</option>
        <option value="Operasional">Operasional</option>
        <option value="K3 Umum">K3 Umum</option>
      </select>
    </div>

    <div class="col-12">
      <label class="form-label">Uraian Temuan (Detail)</label>
      <textarea id="f_uraian" class="form-control" rows="4" required placeholder="Deskripsikan kondisi, lokasi, waktu, dan bukti pendukung"></textarea>
    </div>

    <div class="col-md-6">
      <label class="form-label">Rekomendasi Tindak Lanjut</label>
      <textarea id="f_rekomendasi" class="form-control" rows="3" placeholder="Rekomendasi teknis/administratif"></textarea>
    </div>
    <div class="col-md-3">
      <label class="form-label">Target Tindak Lanjut (YYYY-MM-DD)</label>
      <input type="date" id="f_target_tl" class="form-control" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Referensi Hukum / Peraturan</label>
      <input type="text" id="f_ref_hukum" class="form-control" placeholder="Pasal / Peraturan (jika ada)" />
    </div>

    <!-- Risk calculator -->
    <div class="col-md-2">
      <label class="form-label">Severity (S)</label>
      <input type="number" id="f_sev" min="0" max="10" class="form-control" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Likelihood (L)</label>
      <input type="number" id="f_like" min="0" max="10" class="form-control" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Risk Score</label>
      <input type="number" id="f_risk" class="form-control" readonly />
    </div>
    <div class="col-md-2">
      <label class="form-label">Risk Category</label>
      <input type="text" id="f_risk_cat" class="form-control" readonly />
    </div>

    <div class="col-md-4">
      <label class="form-label">Status (default Open)</label>
      <select id="f_status" class="form-select" disabled>
        <option>Open</option>
      </select>
    </div>

    <div class="col-md-6">
      <label class="form-label">GPS (lat,lng)</label>
      <input type="text" id="f_gps" class="form-control" placeholder="contoh: -1.2345, 116.1234" />
      <div class="small text-muted">Opsional: masukkan koordinat lokasi inspeksi</div>
    </div>

    <div class="col-md-6">
      <label class="form-label">Foto Bukti</label>
      <input type="file" id="f_photos" class="form-control" accept="image/*" multiple />
      <div class="small text-muted">Foto akan disimpan sebagai attachment di PouchDB.</div>
    </div>

    <div class="col-12 text-end">
      <button type="submit" class="btn btn-primary">Simpan (Lokal)</button>
      <button type="button" class="btn btn-outline-secondary" onclick="router.navigateTo('dashboard')">Batal</button>
    </div>
  </form>
</div>

<script>
  // Validasi form bootstrap simple
  (function () {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.prototype.slice.call(forms).forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        form.classList.add('was-validated')
      }, false)
    })
  })();
</script>
